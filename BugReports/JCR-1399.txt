Backport JCR-1197: Node.restore() may throw InvalidItemStateException



Description:
Backport issue JCR-1197 (Node.restore() may throw InvalidItemStateException) to 1.3 branch for 1.3.4 (separate issue to avoid re-opening JCR-1197 which was already released with 1.4).
